# @package _global_

# to execute this experiment run:
# python train.py experiment=so_ec_species_detector_base_vae

defaults:
  - override /data: soundscape_vae_embeddings
  - override /model: species_detector
  - override /trainer: gpu
  - override /logger: wandb

# all parameters below will be merged with parameters from default configurations set above
# this allows you to overwrite only specified parameters

train: true
test: true

tags: ["SO", "UK", "base_vae", "v4"]

seed: 42

data:
  root: ./data/soundscape_vae_embeddings/base_vae.pt:v4/SO/country=='UK'/

trainer:
  max_epochs: 1000
  check_val_every_n_epoch: 50
  log_every_n_steps: 1

model:
  species_list_path: ./data/soundscape_vae_embeddings/base_vae.pt:v4/SO/country=='UK'/species.yaml
  attn_dim: 10
  pool_method: prob_attn
  clf_learning_rate: 0.1
  attn_learning_rate: 0.01

logger:
  wandb:
    tags: ${tags}
    group: sounding_out_uk

callbacks:
  model_checkpoint:
    dirpath: ${paths.output_dir}/checkpoints
    filename: epoch_{epoch:03d}
    monitor: val/loss
    mode: min
    save_top_k: -1
    auto_insert_metric_name: False
  species_scores:
    _target_: src.core.callbacks.species_scores.SpeciesScores
    save_dir: ${paths.output_dir}
