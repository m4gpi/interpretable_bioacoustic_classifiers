# @package _global_

# python train.py experiment=so_ec_species_detector_shifti_invariant_vae

defaults:
  - override /data: soundscape_vae_embeddings
  - override /model: species_detector
  - override /trainer: gpu
  - override /logger: wandb

train: true
test: true

seed: 42

data:
  root: /its/home/kag25/projects/ecolistening/interpretable_bioacoustic_classifiers/data/soundscape_vae_embeddings
  model: smooth_nifti_vae
  version: v12
  scope: SO/EC

trainer:
  max_epochs: 1000
  check_val_every_n_epoch: 50
  log_every_n_steps: 1

model:
  species_list_path: ${data.root}/${data.model}.pt:${data.version}/${data.scope}/species.yaml
  beta: 0.0
  label_smoothing: 0.1
  attn_dim: 10
  pool_method: feature_attn
  clf_learning_rate: 0.1
  attn_learning_rate: 0.01

callbacks:
  model_checkpoint:
    dirpath: ${paths.output_dir}/checkpoints
    filename: epoch_{epoch:03d}
    monitor: val/loss
    mode: min
    save_top_k: -1
    auto_insert_metric_name: False
  species_scores:
    _target_: src.core.callbacks.species_scores.SpeciesScores
    save_dir: ${paths.output_dir}

logger:
  wandb:
    tags: ${tags}
    group: sounding_out_ecuador
