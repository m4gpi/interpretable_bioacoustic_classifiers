# @package _global_

# python src/cli/train.py +experiment=species_detector

defaults:
  - override /data: soundscape_vae_embeddings
  - override /model: species_detector
  - override /trainer: gpu
  - override /logger: null

name: interpretable_bioacoustic_classifiers
results_dir: ${paths.results_dir}/${name}/${data.scope}/${data.model}/${data.version}

train: true
test: true
seed: 42

data:
  root: ${paths.data_dir}/soundscape_vae_embeddings
  model: smooth_nifti_vae
  version: v12
  scope: SO_EC

trainer:
  max_epochs: 1000
  check_val_every_n_epoch: 50
  log_every_n_steps: 1

model:
  beta: 0.0
  label_smoothing: 0.1
  attn_dim: 10
  pool_method: feature_attn
  clf_learning_rate: 0.1
  attn_learning_rate: 0.01

callbacks:
  model_checkpoint:
    dirpath: ${results_dir}/checkpoints
    filename: epoch_{epoch:03d}
    monitor: val/loss
    mode: min
    save_top_k: -1
    auto_insert_metric_name: False
  species_scores:
    _target_: src.core.callbacks.species_scores.SpeciesScores
    save_dir: ${results_dir}

logger:
  wandb:
    group: ${data.scope}
