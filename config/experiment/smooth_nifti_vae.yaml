# @package _global_

# python main.py +experiment=smooth_nifti_vae

defaults:
  - override /model: smooth_nifti_vae
  - override /data: sounding_out_chorus
  - override /transforms: cropped_log_mel_spectrogram
  - override /trainer: gpu
  - override /logger: null

train: true
test: true
seed: 42

data:
  seed: ${seed}
  root: ${oc.env:HOME}/data/sounding_out

model:
  sigma_z_max: 0.2
  sigma_z_mode: FIXED
  smooth_prop: 0.5
  p_dt_step_start: 0
  p_dt_step_end: 20_000
  p_dt_sigma_min: 0.1
  p_dt_sigma_max: 2.0
  learning_rate: 4.e-5
  optimiser_cls: torch.optim.AdamW
  scheduler_cls: torch.optim.lr_scheduler.CosineAnnealingLR
  scheduler_config:
    T_max: 40_000
    eta_min: 4.e-7

trainer:
  max_steps: 180_000
  max_epochs: -1
  log_every_n_steps: 100
  val_check_interval: 2500

callbacks:
  model_checkpoint:
    dirpath: ${paths.model_dir}/checkpoints/smooth_nifti
    filename: 'ds=chorus_{step}'
    every_n_train_steps: 60_000
    save_top_k: -1

logger:
  id: ${run_id}
  project: species_detector_pretraining
  group: smooth_nifti_vae
